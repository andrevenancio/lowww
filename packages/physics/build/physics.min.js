/*
lowww-physics - version: 1.1.4
Copyright Â© 2018 Andre Venancio (info@andrevenancio.com)
*/
var e;e=function(e){"use strict";var n="undefined"!=typeof Float32Array?Float32Array:Array;function i(){var e=new n(3);return e[0]=0,e[1]=0,e[2]=0,e}function r(e,t,i){var o=new n(3);return o[0]=e,o[1]=t,o[2]=i,o}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function t(e,t,i,o){return e[0]=t[0]+i[0]*o,e[1]=t[1]+i[1]*o,e[2]=t[2]+i[2]*o,e}Math.PI;var s;function a(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}i(),(s=new n(4))[0]=0,s[1]=0,s[2]=0,s[3]=0;var h;i(),r(1,0,0),r(0,1,0),a(),a(),(h=new n(9))[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,(c=new n(2))[0]=0,c[1]=0;var c,u="sphere-collider",l="rigid-body",f="force",d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},p=function(){function o(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}}(),y=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},v=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},b=0,w=0,m=0,k=0,g=0,O=0,_=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};d(this,t),w=e.timestep||1/180,m=e.time||Date.now()/1e3,this.force=i(),this.bodies=[],this.forces=[],this.paused=!0}return p(t,[{key:"add",value:function(e){e.type===l&&this.bodies.push(e),e.type===f&&this.forces.push(e)}},{key:"remove",value:function(e){if(e.type===l){var t=this.bodies.indexOf(e);-1!==t&&this.bodies.splice(t,1)}if(e.type===f){var i=this.forces.indexOf(e);-1!==i&&this.forces.splice(i,1)}}},{key:"pause",value:function(){!1===this.paused&&(this.paused=!0)}},{key:"resume",value:function(){!0===this.paused&&(this.paused=!1)}},{key:"update",value:function(){if(!this.paused){for(g=Date.now()/1e3,.25<(O=g-m)&&(O=.25),m=g,k+=O;w<=k;)this.step(),b+=w,k-=w;this.render()}}},{key:"step",value:function(){this.handleForces(),this.handleVelocity(),this.handleCollision(),this.handleMomentum()}},{key:"handleForces",value:function(){this.force[0]=0,this.force[1]=0;for(var e=this.force[2]=0;e<this.forces.length;e++)this.force[0]+=this.forces[e].data[0],this.force[1]+=this.forces[e].data[1],this.force[2]+=this.forces[e].data[2];for(var t=0;t<this.bodies.length;t++)this.bodies[t].handleForces(this.force)}},{key:"handleVelocity",value:function(){for(var e=0;e<this.bodies.length;e++)this.bodies[e].handleVelocity(w)}},{key:"handleMomentum",value:function(){for(var e=0;e<this.bodies.length;e++)this.bodies[e].handleMomentum(w)}},{key:"handleCollision",value:function(){}},{key:"render",value:function(){for(var e=0;e<this.bodies.length;e++)this.bodies[e].render(b)}}]),t}(),j=function(){function e(){d(this,e),this.position=i(),this.velocity=i(),this.acceleration=i(),this.force=i(),this.awake=!1}return p(e,[{key:"handleForces",value:function(e){o(this.force,e)}},{key:"handleVelocity",value:function(e){this.acceleration[0]=this.force[0]/this.mass,this.acceleration[1]=this.force[1]/this.mass,this.acceleration[2]=this.force[2]/this.mass,t(this.velocity,this.velocity,this.acceleration,e),t(this.position,this.position,this.velocity,e)}},{key:"handleMomentum",value:function(){}},{key:"render",value:function(){o(this.mesh.position.data,this.position)}}]),e}(),P=function(e){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};d(this,i);var t=v(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));if(!e.collider)throw new Error("Please provide a collider");if(!e.mesh)throw new Error("Please provide a mesh");return Object.assign(t,{type:l,mass:1},e),o(t.position,t.mesh.position.data),t}return y(i,j),i}(),F=function(){function t(e){d(this,t),this.type=e}return p(t,[{key:"collideSphere",value:function(){}},{key:"collideAABB",value:function(){}},{key:"collide",value:function(e){e.type===u&&this.collideSphere()}}]),t}(),x=function(e){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};d(this,i);var t=v(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u));return t.radius=e.radius||1,t}return y(i,F),i}();e.World=_,e.RigidBody=P,e.SphereCollider=x,e.Force=function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;d(this,e),this.type=f,this.data=r(t,i,o)},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((this.lowww=this.lowww||{},this.lowww.physics={}));
